# 의사결정 로직 작성 가이드

## 구현 단계
1. 자연어로 의사결정 논리 작성 → 사용자 확인
2. 확인된 논리를 바탕으로 코드 작성 → 사용자 확인
3. 모듈화 가능성 검토 후 최종 코드 생성

## 모듈화 체크리스트
- 이 함수가 3개 이상 호출되는가?
- 다른 컨텍스트에서 재사용 가능한가?
- 단일 책임 원칙을 따르는가?

## 안티패턴
- 한 번에 전체 의사결정 트리를 코드로 생성하지 말 것
- 자연어 논리 없이 바로 코드를 작성하지 말 것
- 여러 모듈을 한 번에 생성하지 말 것

---

## CLARA-SSoT 특화: 코드-문서 동기화

### 코드 변경 후 필수 확인
| 변경 대상 | 업데이트 대상 |
|---|---|
| 모듈 추가/삭제, 데이터 흐름 변경 | `docs/ARCHITECTURE.md` |
| 기능 추가/제거, 설계 목표 변경 | `docs/DESIGN.md` |
| 커맨드/의존성 변경 | `CLAUDE.md # 커맨드` |

### Ingestion 파이프라인 변경 시
파이프라인 단계(parsing → normalization → landing → validation → ssot) 중 하나라도 변경되면:
- `docs/ARCHITECTURE.md`의 데이터 흐름 다이어그램 업데이트
- 변경된 단계의 입출력 스키마 명시

### API 엔드포인트 추가 시 체크리스트
- [ ] 라우터 파일 위치: `src/clara_ssot/api/`
- [ ] Pydantic 요청/응답 모델 정의 (타입 힌트 필수)
- [ ] 에러는 `ProblemDetails` + `MachineReadableError` 형태로 반환
- [ ] 테스트 작성 (`tests/`)
- [ ] `docs/DESIGN.md` 기능 요구사항 업데이트
